<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:composite="http://java.sun.com/jsf/composite">

<composite:interface>

	
	<composite:attribute name="label" type="java.lang.String" />
	
	<composite:attribute name="valor" />
	
	
	<composite:attribute name="renderRemote" type="java.lang.String" />

	<composite:attribute name="eventHandler" 
		method-signature="java.lang.String action()" />
	

</composite:interface>

<composite:implementation>
	
	<style>
	.editableLabel {
		vertical-align: middle;
	    line-height: 30px;
	}
	</style>
	<script type="text/javascript">
		$(document).ready(function() {
			initialize();
		});
		
		function initialize() {
			var idValor = "#{cc.attrs.clientId}Valor";
			var idInput = "#{cc.attrs.clientId}InputValue";
			var idNombreControl = "#{cc.attrs.clientId}NombreControl";
			
			var editable = $(scapeId(idNombreControl)).attr("editable");
			if(editable==undefined) {
				$(scapeId(idNombreControl)).attr("editable","false");
			}
			editable = $(scapeId(idNombreControl)).attr("editable");		
			if(editable == "true") {
				$(scapeId(idInput)).css("display","");
				$(scapeId(idValor)).css("display","none");
			} else {
				$(scapeId(idInput)).css("display","none");
				$(scapeId(idValor)).css("display","");
			}
			
		}
		function keyListenerEditable(event) {
			debugger;
			var idValor = "#{cc.attrs.clientId}Valor";
			var idInput = "#{cc.attrs.clientId}InputValue";
			var idNombreControl = "#{cc.attrs.clientId}NombreControl";
			
			if(event.keyCode == "13") {
				var valorTemporal = $(scapeId(idInput)).children().val();
				$(scapeId(idValor)).html(valorTemporal);
				event.preventDefault();
				event.stopPropagation();
				editable4Value();
				return false;
			}
			
			if(event.keyCode == "27") {
				
				var valorTemporal = $(scapeId(idValor)).html();
				$(scapeId(idInput)).children().val(valorTemporal);
				event.preventDefault();
				event.stopPropagation();
				editable4Value();
				return false;
			}
			
			
		}
		function editable4Value() {
			var idValor = "#{cc.attrs.clientId}Valor";
			var idInput = "#{cc.attrs.clientId}InputValue";
			var idNombreControl = "#{cc.attrs.clientId}NombreControl";
			var editable = $(scapeId(idNombreControl)).attr("editable");		
			if(editable == "true") {
				$(scapeId(idInput)).css("display","none");
				$(scapeId(idValor)).css("display","");
				$(scapeId(idNombreControl)).attr("editable","false");
			} else {
				debugger;
				$(scapeId(idInput)).css("display","");
				$($(scapeId(idInput)).children()).focus();
				$(scapeId(idValor)).css("display","none");
				$(scapeId(idNombreControl)).attr("editable","true");
			}
		}
	</script>
	
		<div class="row-fluid 	">		
			<div class="span3 " id="#{cc.attrs.clientId}NombreControl">#{cc.attrs.label}</div>
			<div class="span3 editableLabel" id="#{cc.attrs.clientId}Valor" onclick="editable4Value();" >#{cc.attrs.value}</div>
			<div class="span3 " id="#{cc.attrs.clientId}InputValue" ><h:inputText class="margin-0X" value="#{cc.attrs.value}"  onkeydown="keyListenerEditable(event);"></h:inputText>  </div>
			
			<div class="span3 vertical-center">
				<h:commandButton id="jsf" actionListener="#{cc.attrs.eventHandler}" value="Enviar JSF" onclick="mensajeAlerta(this);">
					<f:ajax execute="@form" render="@this" />
				</h:commandButton>
			 </div>
		</div>
	<div class="row-fluid 	">
	<div style="border:5px solid black;">
	<input type="button" value="intercambiar" onclick="mensajeAlerta();"></input>
	<input type="button" value="editar" onclick="editable4Value();"></input>
	#{component.parent.clientId}----
	#{cc.attrs.clientId}
	</div>
	</div>
	

</composite:implementation>

</html>